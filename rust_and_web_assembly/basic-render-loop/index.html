<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
  </head>
  <body>
    <!-- Include the JS generated by `wasm-pack build` -->
    <script src='pkg/game_of_life.js'></script>

    <script type=module>
      // Like with the `--target web` output the exports are immediately
      // available but they won't work until we initialize the module. Unlike
      // `--target web`, however, the globals are all stored on a
      // `wasm_bindgen` global. The global itself is the initialization
      // function and then the properties of the global are all the exported
      // functions.
      //
      // Note that the name `wasm_bindgen` can be configured with the
      // `--no-modules-global` CLI flag
      const { Renderer } = wasm_bindgen;

      async function run() {
        await wasm_bindgen('./pkg/game_of_life_bg.wasm');
      }

      function loaded() {
        const pre = document.getElementById("game-of-life-canvas");
        const renderer = Renderer.new();

        const renderLoop = () => {
          pre.textContent = renderer.render();

          requestAnimationFrame(renderLoop);
        };
        requestAnimationFrame(renderLoop);
      }

      run().then(loaded);
    </script>
    <pre id="game-of-life-canvas"></pre>
  </body>
</html>
